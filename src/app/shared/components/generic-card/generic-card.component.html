<ion-card
  class="shadow-with-radious generic-card min-h-100 d-flex flex-col"
  (click)="onCardClick(data)"
>
  <div class="generic-card-header d-grid relative" *ngIf="meta">
    <div class="tag-container absolute">
    <div *ngIf="isSessionExpired" class="tag expired-tag">{{'EXPIRED' | translate}}</div>
   </div>
    <div class="d-flex flex-align-items-center mx-10">
      <ion-icon
        [ngClass]="meta.isSent ? 'rotate-icon-sent' : 'rotate-icon-receive'"
        name="arrow-back-outline"
      ></ion-icon>
      <p class="max-width-70 wrap-text" style="margin: 2px 5px">
        {{ meta.isSent ? ("SENT" | translate) : ("RECEIVED" | translate) }}
      </p>
    </div>
    <div class="d-flex flex-align-items-center mx-10">
      <ng-container *ngIf="meta.message; else timeIcon">
        <ion-icon name="chatbox"></ion-icon>
      </ng-container>
      <ng-template #timeIcon>
        <ion-icon name="time"></ion-icon>
      </ng-template>

      <ng-container *ngIf="meta.message; else timeBlock">
        <p class="max-width-70 wrap-text" style="margin: 2px 5px">{{ meta.message }}</p>
      </ng-container>

      <ng-template #timeBlock>
        <small style="padding-left: 5px">
          {{ meta.resp.start_date * 1000 | date : "dd MMM yyyy," }}
          {{ meta.resp.start_date * 1000 | date : "h:mm a" }} -
          {{ meta.resp.end_date * 1000 | date : "h:mm a" }}
        </small>
      </ng-template>
    </div>
  </div>
  <div class="card-content flex-1 d-flex gap-3 mx-10 py-2">
    @if(cardConfig.header.image) {
      <div class="image-container">
        <img
          class="profile-img"
          [src]="data?.[cardConfig.header.image] ? data?.[cardConfig.header.image] : 'assets/prof-img/user.png'"
        />
      </div>
    }

    <div class="text-content flex-1">
      <div class="text-row">
        @if(cardConfig.header.title) {
          <h4 class="card-title wrap-text">
            {{ data?.[cardConfig.header.title] | titlecase }}
          </h4>
        }
        @for(item of cardConfig.body; track item.name) {
          <div class="d-flex flex-align-items-center">
            <p class="card-text wrap-text">
              {{ item.type === 'array' && data?.[item.name]?.length ? data?.[item.name][0]?.label : data?.[item.name] }}
            </p>
            @if(item.children) {
            @for(child of item.children; track child.name) {
              @if(data?.[child.name]) {
                <p class="experience-text wrap-text">
                  ({{ data?.[child.name] }} {{child?.subText | translate}})
                </p>
              }
            }
          }
          </div>
        }
      </div>
    </div>
  </div>

      <div
       class="d-flex flex-justify-flex-end p-1"
          [ngClass]="{ 'flex-justify-start': buttonConfig?.length > 1 }"
        >
          <ng-container *ngFor="let button of buttonConfig">
            <ion-button
            size="small"
              *ngIf="showButton(button, data)"
              [color]="button?.color"
x              (click)="
                handleButtonClick(button?.action, data);
                $event.stopPropagation()
              "
            >
              {{ button?.label | translate }}
            </ion-button>
          </ng-container>
        </div>
</ion-card>